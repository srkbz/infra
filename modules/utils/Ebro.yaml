tasks:
  sync-directories:
    abstract: true
    script: |
      rsync --checksum --archive --delete --itemize-changes "$(realpath "$SYNC_FROM")"/ "$(realpath "$SYNC_TO")"/
    when:
      check_fails: |
        [ ! -n "$(rsync --checksum --archive --delete --itemize-changes --dry-run "$(realpath "$SYNC_FROM")"/ "$(realpath "$SYNC_TO")"/)" ]
